groups:
  - name: mdadm.rules
    rules:

    - alert: RAIDArrayNotActive
      expr: node_md_state{state="active"} == 0
      for: 2m
      labels:
        severity: critical
      annotations:
        summary: "RAID array is not active on {{ $labels.instance }} ({{ $labels.device }})"
        description: "RAID device '{{ $labels.device }}' on instance {{ $labels.instance }} is NOT in active state."

    - alert: RAIDArrayInCheck
      expr: node_md_state{state="check"} == 1
      for: 5m
      labels:
        severity: warning
      annotations:
        summary: "RAID array check in progress on {{ $labels.instance }} ({{ $labels.device }})"
        description: "RAID device '{{ $labels.device }}' on instance {{ $labels.instance }} is in CHECK state (consistency check)."

    - alert: RAIDArrayInactive
      expr: node_md_state{state="inactive"} == 1
      for: 1m
      labels:
        severity: critical
      annotations:
        summary: "RAID array inactive on {{ $labels.instance }} ({{ $labels.device }})"
        description: "RAID device '{{ $labels.device }}' on instance {{ $labels.instance }} is INACTIVE."

    - alert: RAIDArrayRecovering
      expr: node_md_state{state="recovering"} == 1
      for: 5m
      labels:
        severity: warning
      annotations:
        summary: "RAID array recovering on {{ $labels.instance }} ({{ $labels.device }})"
        description: "RAID device '{{ $labels.device }}' on instance {{ $labels.instance }} is RECOVERING."

    - alert: RAIDArrayResync
      expr: node_md_state{state="resync"} == 1
      for: 5m
      labels:
        severity: info
      annotations:
        summary: "RAID array resync in progress on {{ $labels.instance }} ({{ $labels.device }})"
        description: "RAID device '{{ $labels.device }}' on instance {{ $labels.instance }} is RESYNCING."
